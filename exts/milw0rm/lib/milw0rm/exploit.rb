require 'ronin/network/http'

module Milw0rm
  class Exploit

    include Ronin

    # Date of the exploit
    attr_reader :date

    # Title of the exploit
    attr_reader :title

    # URL to the exploit
    attr_reader :url

    # Author of the exploit
    attr_reader :author

    #
    # Creates a new Exploit object with the specified _date_, _title_,
    # _url_ and _author_.
    #
    def initialize(date,title,url,author)
      @date = Date.parse(date.to_s)
      @title = title
      @url = url
      @author = author
      @body = nil
    end

    def body
      unless @body
        resp, @body = Net.http_get(:url => @url)

        if resp['content-type'] =~ /text\/(x)?html/
          @body = Web.html(@body).inner_text
        end
      end

      return @body
    end

    alias to_s title

  end
end
